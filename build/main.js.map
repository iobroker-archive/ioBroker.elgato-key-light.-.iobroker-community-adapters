{
  "version": 3,
  "sources": ["../src/main.ts"],
  "sourcesContent": ["// The adapter-core module gives you access to the core ioBroker functions\r\n// you need to create an adapter\r\nimport * as utils from '@iobroker/adapter-core';\r\n// Load your modules here, e.g.:\r\nimport 'source-map-support/register';\r\nimport { KeyLight, KeyLightInfo, KeyLightOptions } from './types/KeyLight';\r\nimport { stateAttrb } from './lib/object_definition';\r\nimport { LightStrip, LightStripOptions } from './types/LightStrip';\r\nimport { hexToHsb, hsbToHex, hsbToRgb, rgbToHsb } from './lib/color';\r\nimport axios from 'axios';\r\nimport sourceMapSupport from 'source-map-support';\r\n\r\nsourceMapSupport.install();\r\n// Global variables here\r\n\r\nclass ElgatoKeyLight extends utils.Adapter {\r\n\tprivate requestTimer: ioBroker.Timeout | null;\r\n\tprivate messageHandler: any[];\r\n\tprivate messageHandlerTimer: ioBroker.Timeout | null;\r\n\tprivate devices: KeyLight[];\r\n\tprivate interval: number;\r\n\tprivate requestObject: KeyLight[];\r\n\r\n\tpublic constructor(options: Partial<utils.AdapterOptions> = {}) {\r\n\t\tsuper({\r\n\t\t\t...options,\r\n\t\t\tname: 'elgato-key-light',\r\n\t\t});\r\n\t\tthis.on('ready', this.onReady.bind(this));\r\n\t\tthis.on('stateChange', this.onStateChange.bind(this));\r\n\t\tthis.on('message', this.onMessage.bind(this));\r\n\t\tthis.on('unload', this.onUnload.bind(this));\r\n\t\tthis.requestTimer = null;\r\n\t\tthis.messageHandlerTimer = null;\r\n\t\tthis.messageHandler = [];\r\n\t\tthis.devices = [];\r\n\t\tthis.interval = 5000;\r\n\t\tthis.requestObject = [];\r\n\t}\r\n\r\n\t/**\r\n\t * Is called when databases are connected and adapter received configuration.\r\n\t */\r\n\tprivate async onReady(): Promise<void> {\r\n\t\t// Initialize your adapter here\r\n\t\tthis.messageHandler = [];\r\n\t\tthis.devices = [];\r\n\t\tthis.requestObject = [];\r\n\t\t// convert the interval to milliseconds\r\n\t\tthis.interval = this.config.interval * 1000;\r\n\t\t// Reset the connection indicator during startup\r\n\t\tthis.setState('info.connection', false, true);\r\n\r\n\t\t// collect all devices from the adapter objects\r\n\t\tconst devices = await this.getDevicesAsync();\r\n\t\tif (devices.length !== 0) {\r\n\t\t\tfor (const devicesKey in devices) {\r\n\t\t\t\tthis.devices.push(devices[devicesKey].native.device);\r\n\t\t\t\tawait this.createStates(devices[devicesKey].native.device);\r\n\t\t\t}\r\n\t\t\tthis.writeLog(`[Adapter v.${this.version} onReady] all devices: ${this.devices.length}`, 'debug');\r\n\t\t\t// console.log('devices', this.devices);\r\n\t\t} else {\r\n\t\t\tthis.writeLog(`[Adapter v.${this.version} onReady] no devices found`, 'debug');\r\n\t\t\tawait this.setStateAsync('info.connections', { val: JSON.stringify([]), ack: true });\r\n\t\t}\r\n\r\n\t\t// start the requestData timer\r\n\t\tthis.writeLog(`[Adapter v.${this.version} onReady] start requestData`, 'debug');\r\n\t\tawait this.requestData();\r\n\t\tthis.setState('info.connection', true, true);\r\n\t}\r\n\r\n\tprivate async requestData(): Promise<void> {\r\n\t\t// Request data from all Key Lights every 5 minutes\r\n\t\tif (this.requestTimer) this.clearTimeout(this.requestTimer);\r\n\t\t// query all key lights\r\n\t\tthis.requestObject = [];\r\n\t\tfor (const device of this.devices) {\r\n\t\t\tconst data: KeyLight = {\r\n\t\t\t\tip: device.ip,\r\n\t\t\t\tport: device.port,\r\n\t\t\t};\r\n\t\t\tthis.writeLog(\r\n\t\t\t\t`[Adapter v.${this.version} requestData] request data for ${device.info?.serialNumber}`,\r\n\t\t\t\t'debug',\r\n\t\t\t);\r\n\t\t\tawait this.requestKeyLight(data);\r\n\t\t}\r\n\r\n\t\tthis.requestTimer = this.setTimeout(() => {\r\n\t\t\tthis.writeLog(`[Adapter v.${this.version} requestData] next request in ${this.interval} ms`, 'debug');\r\n\t\t\tthis.requestData();\r\n\t\t}, this.interval);\r\n\t}\r\n\r\n\tprivate async writeState(device: KeyLight): Promise<void> {\r\n\t\tif (!device) return;\r\n\t\tlet deviceName = '';\r\n\t\t// write the state of the Key Light\r\n\t\tif (device.info) {\r\n\t\t\tthis.writeLog(\r\n\t\t\t\t`[Adapter v.${this.version} writeState] write all info states for ${device.info.displayName}`,\r\n\t\t\t\t'debug',\r\n\t\t\t);\r\n\t\t\tdeviceName = device.info.serialNumber;\r\n\t\t\tawait this.setStateAsync(`${deviceName}.info.ip`, { val: device.ip, ack: true });\r\n\t\t\tawait this.setStateAsync(`${deviceName}.info.port`, { val: device.port, ack: true });\r\n\t\t\tfor (const [key, value] of Object.entries(device.info)) {\r\n\t\t\t\tif (key !== 'wifi-info') {\r\n\t\t\t\t\tif (key === 'features') {\r\n\t\t\t\t\t\tawait this.setStateAsync(`${deviceName}.info.${key}`, {\r\n\t\t\t\t\t\t\tval: JSON.stringify(value),\r\n\t\t\t\t\t\t\tack: true,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else if (key === 'displayName') {\r\n\t\t\t\t\t\t// find the configuration of the device and the index\r\n\t\t\t\t\t\tconst deviceConfig = this.devices.find(\r\n\t\t\t\t\t\t\t(element) => element.info?.serialNumber === device.info?.serialNumber,\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tif (deviceConfig) {\r\n\t\t\t\t\t\t\t// if the name was changed then write the new name into the configuration\r\n\t\t\t\t\t\t\tif (deviceConfig.info?.displayName !== value) {\r\n\t\t\t\t\t\t\t\t// find the index of the device\r\n\t\t\t\t\t\t\t\tconst index = this.devices.findIndex(\r\n\t\t\t\t\t\t\t\t\t(element) => element.info?.serialNumber === device.info?.serialNumber,\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\t\t\t\t\tthis.devices[index].info!.displayName = value as string;\r\n\t\t\t\t\t\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t\t\t\t\t\t`[Adapter v.${this.version} writeState] Change name of ${device.info?.displayName} to ${value}`,\r\n\t\t\t\t\t\t\t\t\t\t'debug',\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\tawait this.setStateAsync(`${deviceName}.info.${key}`, {\r\n\t\t\t\t\t\t\t\t\t\tval: value,\r\n\t\t\t\t\t\t\t\t\t\tack: true,\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tawait this.createStates(device);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t\t\t\t\t`[Adapter v.${this.version} writeState] Name of ${device.info?.displayName} is ${value}`,\r\n\t\t\t\t\t\t\t\t\t'debug',\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\tawait this.setStateAsync(`${deviceName}.info.${key}`, { val: value, ack: true });\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t\t\t`[Adapter v.${this.version} writeState] write state ${key} with value ${value}`,\r\n\t\t\t\t\t\t\t'debug',\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tawait this.setStateAsync(`${deviceName}.info.${key}`, { val: value, ack: true });\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfor (const [key2, value2] of Object.entries(value)) {\r\n\t\t\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t\t\t`[Adapter v.${this.version} writeState] write state ${key2} with value ${value2}`,\r\n\t\t\t\t\t\t\t'debug',\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tawait this.setStateAsync(`${deviceName}.info.wifi-info.${key2}`, {\r\n\t\t\t\t\t\t\tval: value2 as any,\r\n\t\t\t\t\t\t\tack: true,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (device.battery) {\r\n\t\t\tthis.writeLog(`[Adapter v.${this.version} writeState] write battery state`, 'debug');\r\n\t\t\tfor (const [key, value] of Object.entries(device.battery)) {\r\n\t\t\t\tif (key === 'powerSource') {\r\n\t\t\t\t\tawait this.setStateAsync(`${deviceName}.battery.${key}`, {\r\n\t\t\t\t\t\tval: value === 1 ? 'power supplies' : value === 2 ? 'battery' : 'unknown',\r\n\t\t\t\t\t\tack: true,\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (key === 'currentBatteryVoltage') {\r\n\t\t\t\t\tawait this.setStateAsync(`${deviceName}.battery.${key}`, {\r\n\t\t\t\t\t\tval: value / 1000,\r\n\t\t\t\t\t\tack: true,\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (key === 'inputChargeVoltage') {\r\n\t\t\t\t\tawait this.setStateAsync(`${deviceName}.battery.${key}`, {\r\n\t\t\t\t\t\tval: value / 1000,\r\n\t\t\t\t\t\tack: true,\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (key === 'inputChargeCurrent') {\r\n\t\t\t\t\tawait this.setStateAsync(`${deviceName}.battery.${key}`, {\r\n\t\t\t\t\t\tval: value / 1000,\r\n\t\t\t\t\t\tack: true,\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (key === 'level') {\r\n\t\t\t\t\tawait this.setStateAsync(`${deviceName}.battery.${key}`, {\r\n\t\t\t\t\t\tval: Math.round(value),\r\n\t\t\t\t\t\tack: true,\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tawait this.setStateAsync(`${deviceName}.battery.${key}`, { val: value, ack: true });\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (device.settings) {\r\n\t\t\tthis.writeLog(`[Adapter v.${this.version} writeState] write settings state`, 'debug');\r\n\t\t\tfor (const [key, value] of Object.entries(device.settings)) {\r\n\t\t\t\tif (key !== `battery`) {\r\n\t\t\t\t\tif (key === 'powerOnTemperature') {\r\n\t\t\t\t\t\t// convert the temperature from mired to Kelvin\r\n\t\t\t\t\t\tconst temp = Math.round(1000000 / value);\r\n\t\t\t\t\t\tawait this.setStateAsync(`${deviceName}.settings.${key}`, { val: temp, ack: true });\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tawait this.setStateAsync(`${deviceName}.settings.${key}`, { val: value, ack: true });\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (device.settings.battery) {\r\n\t\t\t\t\t\tfor (const [key2, value2] of Object.entries(device.settings.battery)) {\r\n\t\t\t\t\t\t\tif (key2 !== `energySaving`) {\r\n\t\t\t\t\t\t\t\tawait this.setStateAsync(`${deviceName}.settings.battery.${key2}`, {\r\n\t\t\t\t\t\t\t\t\tval: value2 as any,\r\n\t\t\t\t\t\t\t\t\tack: true,\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tfor (const [key3, value3] of Object.entries(device.settings.battery.energySaving)) {\r\n\t\t\t\t\t\t\t\t\tif (key3 !== `adjustBrightness`) {\r\n\t\t\t\t\t\t\t\t\t\tawait this.setStateAsync(\r\n\t\t\t\t\t\t\t\t\t\t\t`${deviceName}.settings.battery.energySaving.${key3}`,\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\tval: value3 as any,\r\n\t\t\t\t\t\t\t\t\t\t\t\tack: true,\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tfor (const [key4, value4] of Object.entries(\r\n\t\t\t\t\t\t\t\t\t\t\tdevice.settings.battery.energySaving.adjustBrightness,\r\n\t\t\t\t\t\t\t\t\t\t)) {\r\n\t\t\t\t\t\t\t\t\t\t\tawait this.setStateAsync(\r\n\t\t\t\t\t\t\t\t\t\t\t\t`${deviceName}.settings.battery.energySaving.adjustBrightness.${key4}`,\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tval: value4 as any,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tack: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (device.light) {\r\n\t\t\tthis.writeLog(`[Adapter v.${this.version} writeState] write light state`, 'debug');\r\n\t\t\tfor (const [key, value] of Object.entries(device.light)) {\r\n\t\t\t\tif (key !== `lights`) {\r\n\t\t\t\t\tawait this.setStateAsync(`${deviceName}.light.${key}`, { val: value, ack: true });\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfor (const [key2, value2] of Object.entries(device.light.lights)) {\r\n\t\t\t\t\t\tfor (const [key3, value3] of Object.entries(value2)) {\r\n\t\t\t\t\t\t\tif (key3 === 'brightness') {\r\n\t\t\t\t\t\t\t\tawait this.setStateAsync(`${deviceName}.light.lights.${key2}.${key3}`, {\r\n\t\t\t\t\t\t\t\t\tval: value3 as number,\r\n\t\t\t\t\t\t\t\t\tack: true,\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (key3 === 'saturation') {\r\n\t\t\t\t\t\t\t\tawait this.setStateAsync(`${deviceName}.light.lights.${key2}.${key3}`, {\r\n\t\t\t\t\t\t\t\t\tval: value3 as number,\r\n\t\t\t\t\t\t\t\t\tack: true,\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (key3 === 'on') {\r\n\t\t\t\t\t\t\t\tawait this.setStateAsync(`${deviceName}.light.lights.${key2}.${key3}`, {\r\n\t\t\t\t\t\t\t\t\tval: value3 === 1,\r\n\t\t\t\t\t\t\t\t\tack: true,\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (key3 === 'temperature') {\r\n\t\t\t\t\t\t\t\t// convert the temperature from mired to Kelvin\r\n\t\t\t\t\t\t\t\tconst kelvin = Math.round(1000000 / value3);\r\n\t\t\t\t\t\t\t\tawait this.setStateAsync(`${deviceName}.light.lights.${key2}.${key3}`, {\r\n\t\t\t\t\t\t\t\t\tval: kelvin,\r\n\t\t\t\t\t\t\t\t\tack: true,\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (key3 === 'hue') {\r\n\t\t\t\t\t\t\t\tawait this.setStateAsync(`${deviceName}.light.lights.${key2}.${key3}`, {\r\n\t\t\t\t\t\t\t\t\tval: value3 as number,\r\n\t\t\t\t\t\t\t\t\tack: true,\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\tif (device.info?.productName === 'Elgato Light Strip') {\r\n\t\t\t\t\t\t\t\t\tconst stripDevice = device.light as LightStripOptions;\r\n\t\t\t\t\t\t\t\t\tlet hue = stripDevice.lights[0].hue;\r\n\t\t\t\t\t\t\t\t\tlet sat = stripDevice.lights[0].saturation;\r\n\t\t\t\t\t\t\t\t\tlet bri = stripDevice.lights[0].brightness;\r\n\r\n\t\t\t\t\t\t\t\t\tif (!hue) hue = 0;\r\n\t\t\t\t\t\t\t\t\tif (!sat) sat = 0;\r\n\t\t\t\t\t\t\t\t\tif (!bri) bri = 0;\r\n\r\n\t\t\t\t\t\t\t\t\tconst hex = hsbToHex(hue, sat, bri);\r\n\t\t\t\t\t\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t\t\t\t\t\t`[Adapter v.${this.version} writeState] convert hsb hue: ${hue}, sat: ${sat}, bri: ${bri} to hex: ${hex} for device: ${deviceName} and write to state `,\r\n\t\t\t\t\t\t\t\t\t\t'debug',\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\tconst rgb = hsbToRgb(hue, sat, bri);\r\n\r\n\t\t\t\t\t\t\t\t\tawait this.setStateAsync(`${deviceName}.light.lights.${key2}.hex`, {\r\n\t\t\t\t\t\t\t\t\t\tval: hex,\r\n\t\t\t\t\t\t\t\t\t\tack: true,\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tawait this.setStateAsync(`${deviceName}.light.lights.${key2}.rgb`, {\r\n\t\t\t\t\t\t\t\t\t\tval: rgb,\r\n\t\t\t\t\t\t\t\t\t\tack: true,\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate async createStates(device: KeyLight): Promise<void> {\r\n\t\tlet deviceName = '';\r\n\t\t// check if the info is available in device\r\n\t\tif (device.info) {\r\n\t\t\tdeviceName = device.info.serialNumber;\r\n\t\t\tthis.writeLog(\r\n\t\t\t\t`[Adapter v.${this.version} createStates] create info states for device: ${deviceName}`,\r\n\t\t\t\t'debug',\r\n\t\t\t);\r\n\t\t\t// create the device\r\n\t\t\tawait this.extendObjectAsync(deviceName, {\r\n\t\t\t\ttype: 'device',\r\n\t\t\t\tcommon: {\r\n\t\t\t\t\tname: device.info.displayName || device.info.productName,\r\n\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\r\n\t\t\t\t\t// @ts-ignore\r\n\t\t\t\t\tstatusStates: {\r\n\t\t\t\t\t\tonlineId: `${this.namespace}.${deviceName}.reachable`,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tnative: {\r\n\t\t\t\t\tip: device.ip,\r\n\t\t\t\t\tport: device.port,\r\n\t\t\t\t\tdevice: device,\r\n\t\t\t\t},\r\n\t\t\t});\r\n\r\n\t\t\t// create the channel for the states\r\n\t\t\tawait this.extendObjectAsync(`${deviceName}.info`, {\r\n\t\t\t\ttype: 'channel',\r\n\t\t\t\tcommon: {\r\n\t\t\t\t\tname: `${device.info?.displayName} / Info`,\r\n\t\t\t\t\tdesc: 'Information about the device',\r\n\t\t\t\t},\r\n\t\t\t\tnative: {},\r\n\t\t\t});\r\n\r\n\t\t\tawait this.extendObjectAsync(`${deviceName}.identify`, {\r\n\t\t\t\ttype: 'state',\r\n\t\t\t\tcommon: {\r\n\t\t\t\t\tname: `${device.info.displayName} / Identify`,\r\n\t\t\t\t\tdesc: 'Identify the device',\r\n\t\t\t\t\ttype: 'boolean',\r\n\t\t\t\t\trole: 'button',\r\n\t\t\t\t\tdef: true,\r\n\t\t\t\t\tread: true,\r\n\t\t\t\t\twrite: true,\r\n\t\t\t\t},\r\n\t\t\t\tnative: {\r\n\t\t\t\t\tip: device.ip,\r\n\t\t\t\t\tport: device.port,\r\n\t\t\t\t\tproductName: device.info.productName,\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t\tthis.subscribeStates(`${deviceName}.identify`);\r\n\r\n\t\t\tawait this.extendObjectAsync(`${deviceName}.reachable`, {\r\n\t\t\t\ttype: 'state',\r\n\t\t\t\tcommon: {\r\n\t\t\t\t\tname: `${device.info?.displayName} / Reachable`,\r\n\t\t\t\t\tdesc: 'Is the device reachable',\r\n\t\t\t\t\ttype: 'boolean',\r\n\t\t\t\t\trole: 'indicator.reachable',\r\n\t\t\t\t\tdef: false,\r\n\t\t\t\t\tread: true,\r\n\t\t\t\t\twrite: false,\r\n\t\t\t\t},\r\n\t\t\t\tnative: {},\r\n\t\t\t});\r\n\r\n\t\t\tawait this.extendObjectAsync(`${deviceName}.info.ip`, {\r\n\t\t\t\ttype: 'state',\r\n\t\t\t\tcommon: {\r\n\t\t\t\t\tname: `${device.info?.displayName} / IP Address`,\r\n\t\t\t\t\tdesc: 'IP of the device',\r\n\t\t\t\t\ttype: 'string',\r\n\t\t\t\t\trole: 'info.ip',\r\n\t\t\t\t\tread: true,\r\n\t\t\t\t\twrite: false,\r\n\t\t\t\t},\r\n\t\t\t\tnative: {\r\n\t\t\t\t\tip: device.ip,\r\n\t\t\t\t\tport: device.port,\r\n\t\t\t\t\tproductName: device.info.productName,\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t\tawait this.extendObjectAsync(`${deviceName}.info.port`, {\r\n\t\t\t\ttype: 'state',\r\n\t\t\t\tcommon: {\r\n\t\t\t\t\tname: `${device.info?.displayName} / Port`,\r\n\t\t\t\t\tdesc: 'Port of the device',\r\n\t\t\t\t\ttype: 'number',\r\n\t\t\t\t\trole: 'info.port',\r\n\t\t\t\t\tread: true,\r\n\t\t\t\t\twrite: false,\r\n\t\t\t\t},\r\n\t\t\t\tnative: {\r\n\t\t\t\t\tip: device.ip,\r\n\t\t\t\t\tport: device.port,\r\n\t\t\t\t\tproductName: device.info.productName,\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t\tawait this.extendObjectAsync(`info.connections`, {\r\n\t\t\t\ttype: 'state',\r\n\t\t\t\tcommon: {\r\n\t\t\t\t\tname: 'Connections',\r\n\t\t\t\t\tdesc: 'Configured connections',\r\n\t\t\t\t\ttype: 'string',\r\n\t\t\t\t\trole: 'json',\r\n\t\t\t\t\tread: true,\r\n\t\t\t\t\twrite: false,\r\n\t\t\t\t},\r\n\t\t\t\tnative: {},\r\n\t\t\t});\r\n\r\n\t\t\tfor (const [key] of Object.entries(device.info)) {\r\n\t\t\t\tif (key !== 'wifi-info') {\r\n\t\t\t\t\tlet common: ioBroker.StateCommon = { name: '', role: '', read: false, write: false };\r\n\t\t\t\t\tcommon = stateAttrb[key as keyof typeof stateAttrb];\r\n\r\n\t\t\t\t\tawait this.extendObjectAsync(`${deviceName}.info.${key}`, {\r\n\t\t\t\t\t\ttype: 'state',\r\n\t\t\t\t\t\tcommon: {\r\n\t\t\t\t\t\t\t...common,\r\n\t\t\t\t\t\t\tname: `${device.info?.displayName} / ${common.name}`,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tnative: {\r\n\t\t\t\t\t\t\tip: device.ip,\r\n\t\t\t\t\t\t\tport: device.port,\r\n\t\t\t\t\t\t\tproductName: device.info.productName,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// check if the state is writable\r\n\t\t\t\t\tif (common.write) {\r\n\t\t\t\t\t\tthis.subscribeStates(`${deviceName}.info.${key}`);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfor (const [key2] of Object.entries(device.info['wifi-info'])) {\r\n\t\t\t\t\t\t// console.log(`${deviceName}.info.wifi-info.${key2}`);\r\n\t\t\t\t\t\tawait this.extendObjectAsync(`${deviceName}.info.${key}`, {\r\n\t\t\t\t\t\t\ttype: 'channel',\r\n\t\t\t\t\t\t\tcommon: {\r\n\t\t\t\t\t\t\t\tname: `${device.info?.displayName} / wifi-info`,\r\n\t\t\t\t\t\t\t\tdesc: 'Information about the wifi',\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tnative: {},\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tlet common: ioBroker.StateCommon = { name: '', role: '', read: false, write: false };\r\n\t\t\t\t\t\tcommon = stateAttrb[key2 as keyof typeof stateAttrb];\r\n\r\n\t\t\t\t\t\tawait this.extendObjectAsync(`${deviceName}.info.${key}.${key2}`, {\r\n\t\t\t\t\t\t\ttype: 'state',\r\n\t\t\t\t\t\t\tcommon: {\r\n\t\t\t\t\t\t\t\t...common,\r\n\t\t\t\t\t\t\t\tname: `${device.info?.displayName} / ${common.name}`,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tnative: {\r\n\t\t\t\t\t\t\t\tip: device.ip,\r\n\t\t\t\t\t\t\t\tport: device.port,\r\n\t\t\t\t\t\t\t\tproductName: device.info.productName,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t//  check if the state is writable\r\n\t\t\t\t\t\tif (common.write) {\r\n\t\t\t\t\t\t\tthis.subscribeStates(`${deviceName}.info.${key}.${key2}`);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// end of info\r\n\t\t}\r\n\t\tif (device.battery) {\r\n\t\t\tthis.writeLog(`[Adapter v.${this.version} createStates] create battery states for ${deviceName}`, 'debug');\r\n\t\t\tawait this.extendObjectAsync(`${deviceName}.battery`, {\r\n\t\t\t\ttype: 'channel',\r\n\t\t\t\tcommon: {\r\n\t\t\t\t\tname: `${device.info?.displayName} / battery Info`,\r\n\t\t\t\t\tdesc: 'battery info of the device',\r\n\t\t\t\t},\r\n\t\t\t\tnative: {},\r\n\t\t\t});\r\n\t\t\tfor (const [key] of Object.entries(device.battery)) {\r\n\t\t\t\tlet common: ioBroker.StateCommon = { name: '', role: '', read: false, write: false };\r\n\t\t\t\tcommon = stateAttrb[key as keyof typeof stateAttrb];\r\n\t\t\t\tawait this.extendObjectAsync(`${deviceName}.battery.${key}`, {\r\n\t\t\t\t\ttype: 'state',\r\n\t\t\t\t\tcommon: {\r\n\t\t\t\t\t\t...common,\r\n\t\t\t\t\t\tname: `${device.info?.displayName} / ${common.name}`,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tnative: {\r\n\t\t\t\t\t\tip: device.ip,\r\n\t\t\t\t\t\tport: device.port,\r\n\t\t\t\t\t\tproductName: device.info?.productName,\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\t// create the states on the key of device.light\r\n\t\tif (device.light) {\r\n\t\t\tthis.writeLog(`[Adapter v.${this.version} createStates] create light states for ${deviceName}`, 'debug');\r\n\t\t\tawait this.extendObjectAsync(`${deviceName}.light`, {\r\n\t\t\t\ttype: 'channel',\r\n\t\t\t\tcommon: {\r\n\t\t\t\t\tname: `${device.info?.displayName} / Light`,\r\n\t\t\t\t\tdesc: 'Light settings of the device',\r\n\t\t\t\t},\r\n\t\t\t\tnative: {},\r\n\t\t\t});\r\n\r\n\t\t\tfor (const [key] of Object.entries(device.light)) {\r\n\t\t\t\tawait this.extendObjectAsync(`${deviceName}.light.${key}`, {\r\n\t\t\t\t\ttype: 'channel',\r\n\t\t\t\t\tcommon: {\r\n\t\t\t\t\t\tname: `${device.info?.displayName} / lights`,\r\n\t\t\t\t\t\tdesc: 'Information about the lights',\r\n\t\t\t\t\t},\r\n\t\t\t\t\tnative: {},\r\n\t\t\t\t});\r\n\t\t\t\tif (key !== `lights`) {\r\n\t\t\t\t\tlet common: ioBroker.StateCommon = {\r\n\t\t\t\t\t\tname: '',\r\n\t\t\t\t\t\trole: '',\r\n\t\t\t\t\t\tread: false,\r\n\t\t\t\t\t\twrite: false,\r\n\t\t\t\t\t};\r\n\t\t\t\t\tcommon = stateAttrb[key as keyof typeof stateAttrb];\r\n\r\n\t\t\t\t\tawait this.extendObjectAsync(`${deviceName}.light.${key}`, {\r\n\t\t\t\t\t\ttype: 'state',\r\n\t\t\t\t\t\tcommon: {\r\n\t\t\t\t\t\t\t...common,\r\n\t\t\t\t\t\t\tname: `${device.info?.displayName} / ${common.name}`,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tnative: {\r\n\t\t\t\t\t\t\tip: device.ip,\r\n\t\t\t\t\t\t\tport: device.port,\r\n\t\t\t\t\t\t\tproductName: device.info?.productName,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// check if the state is writable\r\n\t\t\t\t\tif (common.write) {\r\n\t\t\t\t\t\tthis.subscribeStates(`${deviceName}.light.${key}`);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// create the states on the key of device.light.lights\r\n\t\t\t\t\tfor (const [key2, value2] of Object.entries(device.light.lights)) {\r\n\t\t\t\t\t\tawait this.extendObjectAsync(`${deviceName}.light.${key}.${key2}`, {\r\n\t\t\t\t\t\t\ttype: 'channel',\r\n\t\t\t\t\t\t\tcommon: {\r\n\t\t\t\t\t\t\t\tname: `${device.info?.displayName} / lights.${key2}`,\r\n\t\t\t\t\t\t\t\tdesc: 'Information about the lights',\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tnative: {},\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tfor (const [key3] of Object.entries(value2)) {\r\n\t\t\t\t\t\t\tlet common: ioBroker.StateCommon = {\r\n\t\t\t\t\t\t\t\tname: '',\r\n\t\t\t\t\t\t\t\trole: '',\r\n\t\t\t\t\t\t\t\tread: false,\r\n\t\t\t\t\t\t\t\twrite: false,\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tkey3 == 'hue' ||\r\n\t\t\t\t\t\t\t\tkey3 == 'saturation' ||\r\n\t\t\t\t\t\t\t\tkey3 == 'brightness' ||\r\n\t\t\t\t\t\t\t\tkey3 == 'temperature' ||\r\n\t\t\t\t\t\t\t\tkey3 == 'on'\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tcommon = stateAttrb[key3 as keyof typeof stateAttrb];\r\n\r\n\t\t\t\t\t\t\t\tawait this.extendObjectAsync(`${deviceName}.light.${key}.${key2}.${key3}`, {\r\n\t\t\t\t\t\t\t\t\ttype: 'state',\r\n\t\t\t\t\t\t\t\t\tcommon: {\r\n\t\t\t\t\t\t\t\t\t\t...common,\r\n\t\t\t\t\t\t\t\t\t\tname: `${device.info?.displayName} / ${common.name}`,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tnative: {\r\n\t\t\t\t\t\t\t\t\t\tip: device.ip,\r\n\t\t\t\t\t\t\t\t\t\tport: device.port,\r\n\t\t\t\t\t\t\t\t\t\tproductName: device.info?.productName,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t// check if the state is writable\r\n\t\t\t\t\t\t\t\tif (common.write) {\r\n\t\t\t\t\t\t\t\t\tthis.subscribeStates(`${deviceName}.light.${key}.${key2}.${key3}`);\r\n\t\t\t\t\t\t\t\t\tthis.subscribeStates(`${deviceName}.light.${key}.${key2}.hue`);\r\n\t\t\t\t\t\t\t\t\tthis.subscribeStates(`${deviceName}.light.${key}.${key2}.saturation`);\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif (device.info?.productName === 'Elgato Light Strip') {\r\n\t\t\t\t\t\t\t\t\tconst hex = stateAttrb.hex;\r\n\t\t\t\t\t\t\t\t\tawait this.extendObjectAsync(`${deviceName}.light.${key}.${key2}.hex`, {\r\n\t\t\t\t\t\t\t\t\t\ttype: 'state',\r\n\t\t\t\t\t\t\t\t\t\tcommon: {\r\n\t\t\t\t\t\t\t\t\t\t\t...hex,\r\n\t\t\t\t\t\t\t\t\t\t\tname: `${device.info?.displayName} / ${hex.name}`,\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tnative: {\r\n\t\t\t\t\t\t\t\t\t\t\tip: device.ip,\r\n\t\t\t\t\t\t\t\t\t\t\tport: device.port,\r\n\t\t\t\t\t\t\t\t\t\t\tproductName: device.info?.productName,\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tthis.subscribeStates(`${deviceName}.light.${key}.${key2}.hex`);\r\n\t\t\t\t\t\t\t\t\tconst rgb = stateAttrb.rgb;\r\n\t\t\t\t\t\t\t\t\tawait this.extendObjectAsync(`${deviceName}.light.${key}.${key2}.rgb`, {\r\n\t\t\t\t\t\t\t\t\t\ttype: 'state',\r\n\t\t\t\t\t\t\t\t\t\tcommon: {\r\n\t\t\t\t\t\t\t\t\t\t\t...rgb,\r\n\t\t\t\t\t\t\t\t\t\t\tname: `${device.info?.displayName} / ${rgb.name}`,\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tnative: {\r\n\t\t\t\t\t\t\t\t\t\t\tip: device.ip,\r\n\t\t\t\t\t\t\t\t\t\t\tport: device.port,\r\n\t\t\t\t\t\t\t\t\t\t\tproductName: device.info?.productName,\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tthis.subscribeStates(`${deviceName}.light.${key}.${key2}.rgb`);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t// create the states on the key of device.settings\r\n\t\tif (device.settings) {\r\n\t\t\tthis.writeLog(`[Adapter v.${this.version} createStates] create settings states for ${deviceName}`, 'debug');\r\n\t\t\tawait this.extendObjectAsync(`${deviceName}.settings`, {\r\n\t\t\t\ttype: 'channel',\r\n\t\t\t\tcommon: {\r\n\t\t\t\t\tname: `${device.info?.displayName} / Settings`,\r\n\t\t\t\t\tdesc: 'Settings of the device',\r\n\t\t\t\t},\r\n\t\t\t\tnative: {},\r\n\t\t\t});\r\n\r\n\t\t\tfor (const [key] of Object.entries(device.settings)) {\r\n\t\t\t\tif (key !== `battery`) {\r\n\t\t\t\t\tlet common: ioBroker.StateCommon = { name: '', role: '', read: false, write: false };\r\n\t\t\t\t\tcommon = stateAttrb[key as keyof typeof stateAttrb];\r\n\r\n\t\t\t\t\tawait this.extendObjectAsync(`${deviceName}.settings.${key}`, {\r\n\t\t\t\t\t\ttype: 'state',\r\n\t\t\t\t\t\tcommon: {\r\n\t\t\t\t\t\t\t...common,\r\n\t\t\t\t\t\t\tname: `${device.info?.displayName} / ${common.name}`,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tnative: {\r\n\t\t\t\t\t\t\tip: device.ip,\r\n\t\t\t\t\t\t\tport: device.port,\r\n\t\t\t\t\t\t\tproductName: device.info?.productName,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// check if the state is writable\r\n\t\t\t\t\tif (common.write) {\r\n\t\t\t\t\t\tthis.subscribeStates(`${deviceName}.settings.${key}`);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// end of settings\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (device.settings.battery) {\r\n\t\t\t\t\t\t// create the states on the key of device.settings.battery\r\n\t\t\t\t\t\tfor (const [key2] of Object.entries(device.settings.battery)) {\r\n\t\t\t\t\t\t\tawait this.extendObjectAsync(`${deviceName}.settings.${key}.${key2}`, {\r\n\t\t\t\t\t\t\t\ttype: 'channel',\r\n\t\t\t\t\t\t\t\tcommon: {\r\n\t\t\t\t\t\t\t\t\tname: `${device.info?.displayName} / Energy Saving`,\r\n\t\t\t\t\t\t\t\t\tdesc: 'Information about the energy saving',\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tnative: {},\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tif (key2 !== `energySaving`) {\r\n\t\t\t\t\t\t\t\tawait this.extendObjectAsync(`${deviceName}.settings.${key}`, {\r\n\t\t\t\t\t\t\t\t\ttype: 'channel',\r\n\t\t\t\t\t\t\t\t\tcommon: {\r\n\t\t\t\t\t\t\t\t\t\tname: `${device.info?.displayName} / battery`,\r\n\t\t\t\t\t\t\t\t\t\tdesc: 'Information about the battery',\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tnative: {},\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tlet common: ioBroker.StateCommon = { name: '', role: '', read: false, write: false };\r\n\t\t\t\t\t\t\t\tcommon = stateAttrb[key2 as keyof typeof stateAttrb];\r\n\r\n\t\t\t\t\t\t\t\tawait this.extendObjectAsync(`${deviceName}.settings.${key}.${key2}`, {\r\n\t\t\t\t\t\t\t\t\ttype: 'state',\r\n\t\t\t\t\t\t\t\t\tcommon: {\r\n\t\t\t\t\t\t\t\t\t\t...common,\r\n\t\t\t\t\t\t\t\t\t\tname: `${device.info?.displayName} / ${common.name}`,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tnative: {\r\n\t\t\t\t\t\t\t\t\t\tip: device.ip,\r\n\t\t\t\t\t\t\t\t\t\tport: device.port,\r\n\t\t\t\t\t\t\t\t\t\tproductName: device.info?.productName,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t// check if the state is writable\r\n\t\t\t\t\t\t\t\tif (common.write) {\r\n\t\t\t\t\t\t\t\t\tthis.subscribeStates(`${deviceName}.settings.${key}.${key2}`);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t// end of battery\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// energySaving\r\n\t\t\t\t\t\t\t\tfor (const [key3] of Object.entries(device.settings.battery.energySaving)) {\r\n\t\t\t\t\t\t\t\t\tawait this.extendObjectAsync(`${deviceName}.settings.${key}.${key2}.${key3}`, {\r\n\t\t\t\t\t\t\t\t\t\ttype: 'channel',\r\n\t\t\t\t\t\t\t\t\t\tcommon: {\r\n\t\t\t\t\t\t\t\t\t\t\tname: `${device.info?.displayName} / adjust Brightness`,\r\n\t\t\t\t\t\t\t\t\t\t\tdesc: 'Information about the adjustBrightness',\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tnative: {},\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tif (key3 !== `adjustBrightness`) {\r\n\t\t\t\t\t\t\t\t\t\tlet common: ioBroker.StateCommon = {\r\n\t\t\t\t\t\t\t\t\t\t\tname: '',\r\n\t\t\t\t\t\t\t\t\t\t\trole: '',\r\n\t\t\t\t\t\t\t\t\t\t\tread: false,\r\n\t\t\t\t\t\t\t\t\t\t\twrite: false,\r\n\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\tcommon = stateAttrb[key3 as keyof typeof stateAttrb];\r\n\r\n\t\t\t\t\t\t\t\t\t\tawait this.extendObjectAsync(`${deviceName}.settings.${key}.${key2}.${key3}`, {\r\n\t\t\t\t\t\t\t\t\t\t\ttype: 'state',\r\n\t\t\t\t\t\t\t\t\t\t\tcommon: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t...common,\r\n\t\t\t\t\t\t\t\t\t\t\t\tname: `${device.info?.displayName} / ${common.name}`,\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\tnative: {\r\n\t\t\t\t\t\t\t\t\t\t\t\tip: device.ip,\r\n\t\t\t\t\t\t\t\t\t\t\t\tport: device.port,\r\n\t\t\t\t\t\t\t\t\t\t\t\tproductName: device.info?.productName,\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t// check if the state is writable\r\n\t\t\t\t\t\t\t\t\t\tif (common.write) {\r\n\t\t\t\t\t\t\t\t\t\t\tthis.subscribeStates(`${deviceName}.settings.${key}.${key2}.${key3}`);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t// adjustBrightness\r\n\t\t\t\t\t\t\t\t\t\tfor (const [key4] of Object.entries(\r\n\t\t\t\t\t\t\t\t\t\t\tdevice.settings.battery.energySaving.adjustBrightness,\r\n\t\t\t\t\t\t\t\t\t\t)) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (key4 === `brightness`) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet common: ioBroker.StateCommon = {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: '',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\trole: '',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tread: false,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twrite: false,\r\n\t\t\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\t\t\tcommon = stateAttrb['adjustBrightness' as keyof typeof stateAttrb];\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tawait this.extendObjectAsync(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`${deviceName}.settings.${key}.${key2}.${key3}.${key4}`,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'state',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcommon: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...common,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname: `${device.info?.displayName} / ${common.name}`,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tnative: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tip: device.ip,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tport: device.port,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tproductName: device.info?.productName,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet common: ioBroker.StateCommon = {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: '',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\trole: '',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tread: false,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twrite: false,\r\n\t\t\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\t\t\tcommon = stateAttrb[key4 as keyof typeof stateAttrb];\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tawait this.extendObjectAsync(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`${deviceName}.settings.${key}.${key2}.${key3}.${key4}`,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'state',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcommon: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...common,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname: `${device.info?.displayName} / ${common.name}`,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tnative: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tip: device.ip,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tport: device.port,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tproductName: device.info?.productName,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t// check if the state is writable\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (common.write) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.subscribeStates(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`${deviceName}.settings.${key}.${key2}.${key3}.${key4}`,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t// end of adjustBrightness\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t// end of energySaving\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// end of settings\r\n\t\t\t}\r\n\t\t}\r\n\t\t// create the states on the key of device.battery\r\n\r\n\t\tawait this.setStateAsync(`${deviceName}.reachable`, true, true);\r\n\t\tawait this.setStateAsync('info.connections', { val: JSON.stringify(this.devices), ack: true });\r\n\t}\r\n\r\n\tprivate async addKeyLight(device: KeyLight): Promise<{\r\n\t\terror: boolean;\r\n\t\tmessage: Error | string;\r\n\t}> {\r\n\t\ttry {\r\n\t\t\tconst keyLight: KeyLight = device;\r\n\t\t\t//Grab our Key Light's settings, info, and current options\r\n\t\t\tconst settingsCall = await axios.get(`http://${keyLight.ip}:${keyLight.port}/elgato/lights/settings`);\r\n\t\t\tkeyLight.settings = settingsCall.data;\r\n\r\n\t\t\tconst infoCall = await axios.get(`http://${keyLight.ip}:${keyLight.port}/elgato/accessory-info`);\r\n\t\t\tkeyLight.info = infoCall.data;\r\n\r\n\t\t\tconst optionsCall = await axios.get(`http://${keyLight.ip}:${keyLight.port}/elgato/lights`);\r\n\t\t\tkeyLight.light = optionsCall.data;\r\n\r\n\t\t\tif (keyLight.info?.productName.startsWith('Elgato Key Light Mini')) {\r\n\t\t\t\tconst batteryCall = await axios.get(`http://${keyLight.ip}:${keyLight.port}/elgato/battery-info`);\r\n\t\t\t\tkeyLight.battery = batteryCall.data;\r\n\t\t\t}\r\n\r\n\t\t\t// check if the device is already in the list\r\n\t\t\tif (this.devices.find((element) => element.info?.serialNumber === keyLight.info?.serialNumber)) {\r\n\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t`[Adapter v.${this.version} Axios: ${axios.VERSION} addKeyLight] Device ${keyLight.info?.serialNumber} already in exist`,\r\n\t\t\t\t\t'debug',\r\n\t\t\t\t);\r\n\t\t\t\t// console.log(`Device ${newKeyLight.info?.serialNumber} already in exist`);\r\n\t\t\t} else {\r\n\t\t\t\t// if not in the list then create a new device\r\n\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t`[Adapter v.${this.version} Axios: ${axios.VERSION} addKeyLight] Device ${keyLight.info?.serialNumber} not in exist - add it`,\r\n\t\t\t\t\t'debug',\r\n\t\t\t\t);\r\n\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t`[Adapter v.${this.version} Axios: ${axios.VERSION} addKeyLight] add new device: ${keyLight.info?.serialNumber} => ${keyLight.info?.displayName}`,\r\n\t\t\t\t\t'debug',\r\n\t\t\t\t);\r\n\t\t\t\tthis.devices.push(keyLight);\r\n\t\t\t\tawait this.createStates(keyLight);\r\n\t\t\t}\r\n\t\t\tthis.writeLog(\r\n\t\t\t\t`[Adapter v.${this.version} Axios: ${axios.VERSION} addKeyLight] start createStates for ${keyLight.info?.serialNumber}`,\r\n\t\t\t\t'debug',\r\n\t\t\t);\r\n\r\n\t\t\tthis.writeLog(\r\n\t\t\t\t`[Adapter v.${this.version} Axios: ${axios.VERSION} addKeyLight] start writeState for ${keyLight.info?.serialNumber}`,\r\n\t\t\t\t'debug',\r\n\t\t\t);\r\n\t\t\tawait this.onReady();\r\n\t\t\treturn {\r\n\t\t\t\terror: false,\r\n\t\t\t\tmessage: 'success',\r\n\t\t\t};\r\n\t\t} catch (error) {\r\n\t\t\tthis.writeLog(`[Adapter v.${this.version} Axios: ${axios.VERSION} addKeyLight] ${error}`, 'error');\r\n\t\t\treturn {\r\n\t\t\t\terror: true,\r\n\t\t\t\tmessage: error,\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\tprivate async requestKeyLight(device: KeyLight): Promise<void> {\r\n\t\ttry {\r\n\t\t\tconst keyLight: KeyLight = device;\r\n\t\t\t//Grab our Key Light's settings, info, and current options\r\n\t\t\tconst settingsCall = await axios.get(`http://${keyLight.ip}:${keyLight.port}/elgato/lights/settings`);\r\n\t\t\tkeyLight.settings = settingsCall.data;\r\n\r\n\t\t\tconst infoCall = await axios.get(`http://${keyLight.ip}:${keyLight.port}/elgato/accessory-info`);\r\n\t\t\tkeyLight.info = infoCall.data;\r\n\r\n\t\t\tconst optionsCall = await axios.get(`http://${keyLight.ip}:${keyLight.port}/elgato/lights`);\r\n\t\t\tkeyLight.light = optionsCall.data;\r\n\r\n\t\t\tif (keyLight.info?.productName.startsWith('Elgato Key Light Mini')) {\r\n\t\t\t\tconst batteryCall = await axios.get(`http://${keyLight.ip}:${keyLight.port}/elgato/battery-info`);\r\n\t\t\t\tkeyLight.battery = batteryCall.data;\r\n\t\t\t}\r\n\r\n\t\t\tthis.writeLog(\r\n\t\t\t\t`[Adapter v.${this.version} Axios: ${axios.VERSION}] requestKeyLight] start writeState for ${\r\n\t\t\t\t\tkeyLight.info?.serialNumber\r\n\t\t\t\t} with Data: ${JSON.stringify(keyLight)}`,\r\n\t\t\t\t'debug',\r\n\t\t\t);\r\n\r\n\t\t\tawait this.writeState(keyLight);\r\n\t\t\tthis.requestObject.push(keyLight);\r\n\t\t} catch (error) {\r\n\t\t\tif (error.response) {\r\n\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t`[Adapter v.${this.version} Axios: ${axios.VERSION} updateLightOptions] Error send for ${\r\n\t\t\t\t\t\tdevice.ip\r\n\t\t\t\t\t} ${error.message} >> message: ${JSON.stringify(error.response.data.errors)}`,\r\n\t\t\t\t\t'error',\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t`[Adapter v.${this.version} Axios: ${axios.VERSION} updateLightOptions] Error send for ${device.ip} ${error.message}`,\r\n\t\t\t\t\t'error',\r\n\t\t\t\t);\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @description a function for log output\r\n\t */\r\n\tprivate writeLog(logText: string, logType: 'silly' | 'info' | 'debug' | 'warn' | 'error'): void {\r\n\t\tif (logType === 'warn' || logType === 'error') {\r\n\t\t\tif (this.messageHandler.length > 0) {\r\n\t\t\t\t// check if the logText is not in the messageHandler\r\n\t\t\t\tif (!this.messageHandler.find((message) => message.message === logText)) {\r\n\t\t\t\t\t// push the logText to the messageHandler\r\n\t\t\t\t\tthis.messageHandler.push({\r\n\t\t\t\t\t\tseverity: logType,\r\n\t\t\t\t\t\tclearTimer: false,\r\n\t\t\t\t\t\tmessage: logText,\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (logType === 'warn') this.log.warn(logText);\r\n\t\t\t\t\tif (logType === 'error') this.log.error(logText);\r\n\t\t\t\t\tthis.log.debug(\r\n\t\t\t\t\t\t`[Adapter v.${this.version} writeLog] messageHandler: ` + JSON.stringify(this.messageHandler),\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (!this.messageHandler.find((message) => message.message === logText).clearTimer) {\r\n\t\t\t\t\t\t// set the clearTimer to true\r\n\t\t\t\t\t\tthis.messageHandler.find((message) => message.message === logText).clearTimer = true;\r\n\t\t\t\t\t\t// set the clearTimer to false and clear the messageHandler for the logText after 5 min\r\n\t\t\t\t\t\tthis.messageHandlerTimer = this.setTimeout(() => {\r\n\t\t\t\t\t\t\tthis.messageHandler.find((message) => message.message === logText).clearTimer = false;\r\n\t\t\t\t\t\t\tthis.messageHandler = this.messageHandler.filter((message) => message.message !== logText);\r\n\t\t\t\t\t\t\tthis.log.debug(`[Adapter v.${this.version} writeLog] clear messageHandler for ${logText}`);\r\n\t\t\t\t\t\t}, 300000);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.log.debug(\r\n\t\t\t\t\t\t`[Adapter v.${this.version} writeLog] messageHandler: ` + JSON.stringify(this.messageHandler),\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// push the logText to the messageHandler\r\n\t\t\t\tthis.messageHandler.push({\r\n\t\t\t\t\tseverity: logType,\r\n\t\t\t\t\tclearTimer: false,\r\n\t\t\t\t\tmessage: logText,\r\n\t\t\t\t});\r\n\t\t\t\tif (logType === 'warn') this.log.warn(logText);\r\n\t\t\t\tif (logType === 'error') this.log.error(logText);\r\n\t\t\t\tthis.log.debug(\r\n\t\t\t\t\t`[Adapter v.${this.version} writeLog] messageHandler: ` + JSON.stringify(this.messageHandler),\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (logType === 'silly') this.log.silly(logText);\r\n\t\t\tif (logType === 'info') this.log.info(logText);\r\n\t\t\tif (logType === 'debug') this.log.debug(logText);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic async updateLightOptions(\r\n\t\tdevice: KeyLight,\r\n\t\toptions: KeyLightOptions | LightStripOptions,\r\n\t): Promise<KeyLightOptions | LightStripOptions | undefined> {\r\n\t\ttry {\r\n\t\t\tconst result = await axios.put(`http://${device.ip}:${device.port}/elgato/lights`, options);\r\n\t\t\tif (result.status === 200) {\r\n\t\t\t\tconst resultData = result.data as KeyLightOptions;\r\n\t\t\t\t// console.log(resultData);\r\n\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t`[Adapter v.${this.version} Axios: ${axios.VERSION} updateLightOptions] on for ${\r\n\t\t\t\t\t\tdevice.ip\r\n\t\t\t\t\t} set to ${JSON.stringify(options)}`,\r\n\t\t\t\t\t'debug',\r\n\t\t\t\t);\r\n\t\t\t\treturn resultData;\r\n\t\t\t}\r\n\t\t\t// console.log(\r\n\t\t\t// \t`[Axios: ${axios.VERSION} updateLightOptions] on for ${device.ip} set to ${JSON.stringify(options)}`,\r\n\t\t\t// );\r\n\t\t\tthis.writeLog(\r\n\t\t\t\t`[Adapter v.${this.version} Axios: ${axios.VERSION} updateLightOptions] on for ${\r\n\t\t\t\t\tdevice.ip\r\n\t\t\t\t} set to ${JSON.stringify(options)}`,\r\n\t\t\t\t'debug',\r\n\t\t\t);\r\n\t\t\treturn undefined;\r\n\t\t} catch (error) {\r\n\t\t\tif (error.response) {\r\n\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t`[Adapter v.${this.version} Axios: ${axios.VERSION} updateLightOptions] Error send for ${\r\n\t\t\t\t\t\tdevice.ip\r\n\t\t\t\t\t} ${error.message} >> message: ${JSON.stringify(error.response.data.errors)}`,\r\n\t\t\t\t\t'error',\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t`[Adapter v.${this.version} Axios: ${axios.VERSION} updateLightOptions] Error send for ${device.ip} ${error.message}`,\r\n\t\t\t\t\t'error',\r\n\t\t\t\t);\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic async identify(device: KeyLight): Promise<void> {\r\n\t\ttry {\r\n\t\t\tawait axios.post(`http://${device.ip}:${device.port ? device.port : 9123}/elgato/identify`);\r\n\t\t\tthis.writeLog(\r\n\t\t\t\t`[Adapter v.${this.version} Axios: ${axios.VERSION} onStateChange] identify the device`,\r\n\t\t\t\t'debug',\r\n\t\t\t);\r\n\t\t} catch (error) {\r\n\t\t\tthis.writeLog(\r\n\t\t\t\t`[Adapter v.${this.version} Axios: ${axios.VERSION} onStateChange] identify was not successful: ${error}`,\r\n\t\t\t\t'error',\r\n\t\t\t);\r\n\t\t\tthis.writeLog(`[Adapter v.${this.version} Axios: ${axios.VERSION} onStateChange] ${error}`, 'error');\r\n\t\t}\r\n\t}\r\n\r\n\tpublic async updateLightInfo(device: KeyLight, options: KeyLightInfo): Promise<KeyLightInfo | undefined> {\r\n\t\ttry {\r\n\t\t\tconst result = await axios.put(`http://${device.ip}:${device.port}/elgato/accessory-info`, options);\r\n\t\t\t// console.log(\r\n\t\t\t// \t`[Adapter v.${this.version} Axios: ${axios.VERSION} updateLightInfo] displayName for ${device.ip} set to ${options}`,\r\n\t\t\t// );\r\n\t\t\tthis.writeLog(\r\n\t\t\t\t`[Adapter v.${this.version} Axios: ${axios.VERSION} updateLightInfo] displayName for ${device.ip} set to ${options}`,\r\n\t\t\t\t'debug',\r\n\t\t\t);\r\n\t\t\treturn result.data as KeyLightInfo;\r\n\t\t} catch (error) {\r\n\t\t\tif (error.response) {\r\n\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t`[Adapter v.${this.version} Axios: ${axios.VERSION} updateLightInfo] Error send for ${device.ip} ${\r\n\t\t\t\t\t\terror.message\r\n\t\t\t\t\t} >> message: ${JSON.stringify(error.response.data.errors)}`,\r\n\t\t\t\t\t'error',\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t`[Adapter v.${this.version} Axios: ${axios.VERSION} updateLightInfo] Error send for ${device.ip} ${error.message}`,\r\n\t\t\t\t\t'error',\r\n\t\t\t\t);\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Is called if a subscribed state changes\r\n\t */\r\n\tprivate async onStateChange(id: string, state: ioBroker.State | null | undefined): Promise<void> {\r\n\t\tif (state) {\r\n\t\t\tif (state.from === 'system.adapter.' + this.namespace) {\r\n\t\t\t\t// ignore the state change from the adapter itself\r\n\t\t\t\treturn;\r\n\t\t\t} else {\r\n\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t`[Adapter v.${this.version} onStateChange] state ${id} changed: ${state.val} (ack = ${state.ack})`,\r\n\t\t\t\t\t'debug',\r\n\t\t\t\t);\r\n\t\t\t\tconst stateName = id.split('.').pop();\r\n\t\t\t\tconst obj = await this.getForeignObjectAsync(id);\r\n\r\n\t\t\t\tif (obj) {\r\n\t\t\t\t\tconst native = obj.native;\r\n\t\t\t\t\tif (stateName === 'identify') {\r\n\t\t\t\t\t\tawait this.identify(native as KeyLight);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (stateName === 'on') {\r\n\t\t\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t\t\t`[Adapter v.${this.version} onStateChange] on for ${native.ip} set to ${state.val}`,\r\n\t\t\t\t\t\t\t'debug',\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tconst value = state.val ? 1 : 0;\r\n\t\t\t\t\t\tconst options = {\r\n\t\t\t\t\t\t\tlights: [\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ton: value,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tconst result = await this.updateLightOptions(native as KeyLight, options as KeyLightOptions);\r\n\r\n\t\t\t\t\t\tif (result) {\r\n\t\t\t\t\t\t\tconst on = result.lights[0].on;\r\n\r\n\t\t\t\t\t\t\tif (on === value) {\r\n\t\t\t\t\t\t\t\tconst newOn = on === 1;\r\n\r\n\t\t\t\t\t\t\t\tawait this.setStateAsync(id, newOn, true);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tconst newOn = on === 1;\r\n\t\t\t\t\t\t\t\tawait this.setStateAsync(id, newOn, true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tawait this.setStateAsync(id, result.lights[0].on === 1, true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (stateName === 'displayName') {\r\n\t\t\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t\t\t`[Adapter v.${this.version} onStateChange] displayName for ${native.ip} set to ${state.val}`,\r\n\t\t\t\t\t\t\t'debug',\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tconst value = state.val;\r\n\t\t\t\t\t\tconst options = {\r\n\t\t\t\t\t\t\tdisplayName: value,\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tconst result = await this.updateLightInfo(native as KeyLight, options as KeyLightInfo);\r\n\t\t\t\t\t\tif (result) {\r\n\t\t\t\t\t\t\tconst displayName = result.displayName;\r\n\t\t\t\t\t\t\tif (displayName === value) {\r\n\t\t\t\t\t\t\t\tawait this.setStateAsync(id, value, true);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tawait this.setStateAsync(id, displayName, true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (stateName === 'brightness') {\r\n\t\t\t\t\t\tconst value = state.val as number;\r\n\t\t\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t\t\t`[Adapter v.${this.version} onStateChange] brightness for ${native.ip} set to ${state.val}`,\r\n\t\t\t\t\t\t\t'debug',\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tlet options = {};\r\n\t\t\t\t\t\tif (native.productName === 'Elgato Light Strip') {\r\n\t\t\t\t\t\t\t// search in this.requestObjects for the matching object\r\n\t\t\t\t\t\t\tconst requestObject = this.requestObject.find((obj) => obj.ip === native.ip) as LightStrip;\r\n\t\t\t\t\t\t\tif (requestObject) {\r\n\t\t\t\t\t\t\t\t// check if in requestObject.light.lights[0] the property scene is present\r\n\t\t\t\t\t\t\t\tif (requestObject.light?.lights[0].scene) {\r\n\t\t\t\t\t\t\t\t\toptions = {\r\n\t\t\t\t\t\t\t\t\t\tlights: [\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\tid: requestObject.light.lights[0].id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tname: requestObject.light.lights[0].name,\r\n\t\t\t\t\t\t\t\t\t\t\t\tbrightness: value,\r\n\t\t\t\t\t\t\t\t\t\t\t\tnumberOfSceneElements:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\trequestObject.light.lights[0].numberOfSceneElements,\r\n\t\t\t\t\t\t\t\t\t\t\t\tscene: requestObject.light.lights[0].scene,\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t// console.log(`scene Mode`);\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\toptions = {\r\n\t\t\t\t\t\t\t\t\t\tlights: [\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\tbrightness: value,\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t// console.log(`brightness Mode`);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\toptions = {\r\n\t\t\t\t\t\t\t\tlights: [\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tbrightness: value,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst result = await this.updateLightOptions(native as KeyLight, options as KeyLightOptions);\r\n\t\t\t\t\t\tif (result) {\r\n\t\t\t\t\t\t\tconst brightness = result.lights[0].brightness;\r\n\t\t\t\t\t\t\tif (brightness === value) {\r\n\t\t\t\t\t\t\t\tawait this.setStateAsync(id, value, true);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tawait this.setStateAsync(id, brightness as number, true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (stateName === 'temperature') {\r\n\t\t\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t\t\t`[Adapter v.${this.version} onStateChange] temperature for ${native.ip} set to ${state.val}`,\r\n\t\t\t\t\t\t\t'debug',\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tconst value = state.val as number;\r\n\r\n\t\t\t\t\t\tlet mired = 143;\r\n\t\t\t\t\t\t// convert the temperature from kelvin to mired\r\n\t\t\t\t\t\tif (value) {\r\n\t\t\t\t\t\t\tmired = 1000000 / value;\r\n\t\t\t\t\t\t\t// round off to 0 decimal places\r\n\t\t\t\t\t\t\tmired = Math.round(mired);\r\n\t\t\t\t\t\t\t// check if the value is within the range\r\n\t\t\t\t\t\t\tif (mired < 143) mired = 143;\r\n\t\t\t\t\t\t\tif (mired > 344) mired = 344;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tmired = 143;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tconst options = {\r\n\t\t\t\t\t\t\tlights: [\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttemperature: mired,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tconst result: KeyLightOptions | undefined = await this.updateLightOptions(\r\n\t\t\t\t\t\t\tnative as KeyLight,\r\n\t\t\t\t\t\t\toptions as KeyLightOptions,\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tif (result) {\r\n\t\t\t\t\t\t\tconst temperature = result.lights[0].temperature;\r\n\t\t\t\t\t\t\tif (temperature === mired) {\r\n\t\t\t\t\t\t\t\tawait this.setStateAsync(id, value, true);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (temperature) {\r\n\t\t\t\t\t\t\t\t\t// convert the temperature from mired to kelvin\r\n\t\t\t\t\t\t\t\t\tlet newTemperature = 1000000 / temperature;\r\n\t\t\t\t\t\t\t\t\t// round off to 0 decimal places\r\n\t\t\t\t\t\t\t\t\tnewTemperature = Math.round(newTemperature);\r\n\t\t\t\t\t\t\t\t\tawait this.setStateAsync(id, newTemperature as number, true);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (stateName === 'hue') {\r\n\t\t\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t\t\t`[Adapter v.${this.version} onStateChange] hue for ${native.ip} set to ${state.val}`,\r\n\t\t\t\t\t\t\t'debug',\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tconst value = state.val as number;\r\n\t\t\t\t\t\tconst options = {\r\n\t\t\t\t\t\t\tlights: [\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\thue: value,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tconst result: undefined | LightStripOptions = await this.updateLightOptions(\r\n\t\t\t\t\t\t\tnative as KeyLight,\r\n\t\t\t\t\t\t\toptions as LightStripOptions,\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tif (result) {\r\n\t\t\t\t\t\t\tconst hue = result.lights[0].hue;\r\n\t\t\t\t\t\t\tif (hue === value) {\r\n\t\t\t\t\t\t\t\tawait this.setStateAsync(id, value, true);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tawait this.setStateAsync(id, hue as number, true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (stateName === 'saturation') {\r\n\t\t\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t\t\t`[Adapter v.${this.version} onStateChange] saturation for ${native.ip} set to ${state.val}`,\r\n\t\t\t\t\t\t\t'debug',\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tconst value = state.val as number;\r\n\t\t\t\t\t\tconst options = {\r\n\t\t\t\t\t\t\tlights: [\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tsaturation: value,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tconst result: undefined | LightStripOptions = await this.updateLightOptions(\r\n\t\t\t\t\t\t\tnative as KeyLight,\r\n\t\t\t\t\t\t\toptions as LightStripOptions,\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tif (result) {\r\n\t\t\t\t\t\t\tconst saturation = result.lights[0].saturation;\r\n\t\t\t\t\t\t\tif (saturation === value) {\r\n\t\t\t\t\t\t\t\tawait this.setStateAsync(id, value, true);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tawait this.setStateAsync(id, saturation as number, true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (stateName === 'hex') {\r\n\t\t\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t\t\t`[Adapter v.${this.version} onStateChange] hex for ${native.ip} set to ${state.val}`,\r\n\t\t\t\t\t\t\t'debug',\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tconst value = state.val as string;\r\n\r\n\t\t\t\t\t\tlet hue = 0;\r\n\t\t\t\t\t\tlet sat = 0;\r\n\t\t\t\t\t\tlet bri = 0;\r\n\r\n\t\t\t\t\t\tconst hsb = hexToHsb(value);\r\n\t\t\t\t\t\thue = Math.round(hsb[0]);\r\n\t\t\t\t\t\tsat = Math.round(hsb[1]);\r\n\t\t\t\t\t\tbri = Math.round(hsb[2]);\r\n\r\n\t\t\t\t\t\tconst options = {\r\n\t\t\t\t\t\t\tlights: [\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\thue: hue,\r\n\t\t\t\t\t\t\t\t\tsaturation: sat,\r\n\t\t\t\t\t\t\t\t\tbrightness: bri,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tconst result: undefined | LightStripOptions = await this.updateLightOptions(\r\n\t\t\t\t\t\t\tnative as KeyLight,\r\n\t\t\t\t\t\t\toptions as LightStripOptions,\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tif (result) {\r\n\t\t\t\t\t\t\tconst hex = hsbToHex(\r\n\t\t\t\t\t\t\t\tresult.lights[0].hue as number,\r\n\t\t\t\t\t\t\t\tresult.lights[0].saturation as number,\r\n\t\t\t\t\t\t\t\tresult.lights[0].brightness as number,\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tif (hex === value) {\r\n\t\t\t\t\t\t\t\tawait this.setStateAsync(id, value, true);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tawait this.setStateAsync(id, hex, true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (stateName === 'rgb') {\r\n\t\t\t\t\t\tthis.writeLog(\r\n\t\t\t\t\t\t\t`[Adapter v.${this.version} onStateChange] rgb for ${native.ip} set to ${state.val}`,\r\n\t\t\t\t\t\t\t'debug',\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tconst value = state.val as string;\r\n\r\n\t\t\t\t\t\tlet hue = 0;\r\n\t\t\t\t\t\tlet sat = 0;\r\n\t\t\t\t\t\tlet bri = 0;\r\n\r\n\t\t\t\t\t\tconst rgb = value.split(',');\r\n\t\t\t\t\t\tconst hsb = rgbToHsb(parseInt(rgb[0]), parseInt(rgb[1]), parseInt(rgb[2]));\r\n\t\t\t\t\t\thue = Math.round(hsb[0]);\r\n\t\t\t\t\t\tsat = Math.round(hsb[1]);\r\n\t\t\t\t\t\tbri = Math.round(hsb[2]);\r\n\r\n\t\t\t\t\t\tconst options = {\r\n\t\t\t\t\t\t\tlights: [\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\thue: hue,\r\n\t\t\t\t\t\t\t\t\tsaturation: sat,\r\n\t\t\t\t\t\t\t\t\tbrightness: bri,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tconst result: undefined | LightStripOptions = await this.updateLightOptions(\r\n\t\t\t\t\t\t\tnative as KeyLight,\r\n\t\t\t\t\t\t\toptions as LightStripOptions,\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tif (result) {\r\n\t\t\t\t\t\t\tconst rgb = hsbToRgb(\r\n\t\t\t\t\t\t\t\tresult.lights[0].hue as number,\r\n\t\t\t\t\t\t\t\tresult.lights[0].saturation as number,\r\n\t\t\t\t\t\t\t\tresult.lights[0].brightness as number,\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tif (rgb === value) {\r\n\t\t\t\t\t\t\t\tawait this.setStateAsync(id, value, true);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tawait this.setStateAsync(id, rgb, true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate async onMessage(obj: ioBroker.Message): Promise<void> {\r\n\t\tif (typeof obj === 'object' && obj.message) {\r\n\t\t\tif (obj.command === 'addKeyLight') {\r\n\t\t\t\tconst device = obj.message as KeyLight;\r\n\t\t\t\tconst data: KeyLight = {\r\n\t\t\t\t\tip: device.ip,\r\n\t\t\t\t\tport: 9123,\r\n\t\t\t\t};\r\n\t\t\t\tconst result = await this.addKeyLight(data);\r\n\r\n\t\t\t\tif (result.message === 'success') {\r\n\t\t\t\t\tthis.sendTo(obj.from, obj.command, result, obj.callback);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.sendTo(obj.from, obj.command, result, obj.callback);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (obj.command === 'deleteKeyLight') {\r\n\t\t\t\tconst device = obj.message as { id: string };\r\n\t\t\t\tconst index = this.devices.findIndex((d) => d.info?.serialNumber === device.id);\r\n\t\t\t\tif (index > -1) {\r\n\t\t\t\t\tthis.devices.splice(index, 1);\r\n\t\t\t\t\tthis.writeLog(`[Adapter v.${this.version} onMessage] delete device ${device.id}`, 'debug');\r\n\t\t\t\t\tawait this.delObjectAsync(`${this.namespace}.${device.id}`, { recursive: true });\r\n\t\t\t\t\tawait this.onReady();\r\n\t\t\t\t\tthis.sendTo(obj.from, obj.command, { message: 'success' }, obj.callback);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Is called when adapter shuts down - callback has to be called under any circumstances!\r\n\t */\r\n\tprivate async onUnload(callback: () => void): Promise<void> {\r\n\t\ttry {\r\n\t\t\tthis.writeLog(`[Adapter v.${this.version} onUnload] Adapter stopped`, 'debug');\r\n\t\t\t// Here you must clear all timeouts or intervals that may still be active\r\n\t\t\tif (this.requestTimer) this.clearTimeout(this.requestTimer);\r\n\t\t\tif (this.messageHandlerTimer) this.clearTimeout(this.messageHandlerTimer);\r\n\t\t\tthis.setState('info.connection', false, true);\r\n\t\t\tfor (const devicesKey in this.devices) {\r\n\t\t\t\tthis.setState(`${this.devices[devicesKey].info?.serialNumber}.reachable`, false, true);\r\n\t\t\t}\r\n\r\n\t\t\tcallback();\r\n\t\t} catch (e) {\r\n\t\t\tcallback();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nif (require.main !== module) {\r\n\t// Export the constructor in compact mode\r\n\tmodule.exports = (options: Partial<utils.AdapterOptions> | undefined) => new ElgatoKeyLight(options);\r\n} else {\r\n\t// otherwise start the instance directly\r\n\t(() => new ElgatoKeyLight())();\r\n}\r\n"],
  "mappings": "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",
  "names": ["sourceMapSupport", "_a", "_b", "axios", "obj", "rgb"]
}
